<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>企画チームB 出し物＆得点集計</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Reggae+One&family=Zen+Kaku+Gothic+New:wght@400;700&family=DotGothic16&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #121212;
            --text-color: #f0f0f0;
            --accent-color: #d4af37; /* シャンパンゴールド */
            --quiz-color: #3498db; /* クイズのテーマ色 */
            --correct-color: #e74c3c; /* 正解の色 */
            --box-color: #e74c3c; /* 箱の中身のテーマ色 */
            --card-bg: #1e1e1e;
            --score-bg: #2c3e50;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Zen Kaku Gothic New', sans-serif;
            margin: 0;
            padding: 0;
            padding-bottom: 350px; /* スコアボード用の余白 */
            box-sizing: border-box;
        }

        h1, h2, .score-num, .quiz-number {
            font-family: 'Reggae One', serif;
        }

        .dot-font {
            font-family: 'DotGothic16', sans-serif;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ヘッダー */
        header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 2px solid var(--accent-color);
            margin-bottom: 30px;
        }

        header h1 {
            margin: 0;
            color: var(--accent-color);
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        /* タブ切り替え */
        .tab-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .tab-btn {
            background: transparent;
            border: 2px solid #555;
            color: #888;
            padding: 15px 30px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            font-family: 'Reggae One', serif;
        }

        .tab-btn.active {
            color: #fff;
            border-color: var(--accent-color);
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
            transform: scale(1.05);
        }

        /* コンテンツエリア */
        .content-section {
            display: none;
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid #333;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            font-size: 2rem;
            border-bottom: 2px solid #555;
            padding-bottom: 10px;
            margin-top: 0;
        }

        .quiz-title { color: var(--quiz-color); border-color: var(--quiz-color); }
        .box-title { color: var(--box-color); border-color: var(--box-color); }

        ul {
            font-size: 1.3rem;
            line-height: 1.8;
            list-style-type: none;
            padding-left: 10px;
        }

        li {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }

        li::before {
            content: "▶";
            position: absolute;
            left: 0;
            color: var(--accent-color);
            font-size: 0.8em;
            top: 5px;
        }

        /* --- クイズスタイル追加 --- */
        .quiz-container {
            text-align: center;
        }
        
        .quiz-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }

        .quiz-presenter {
            font-size: 1.5rem;
            color: var(--accent-color);
            font-weight: bold;
        }

        .quiz-number {
            font-size: 2rem;
            color: var(--quiz-color);
        }

        .quiz-media-box {
            width: 100%;
            height: 300px; /* 画像エリアの高さ */
            background: #000;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #333;
        }

        .quiz-media-box img, .quiz-media-box video {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .quiz-question-text {
            font-size: 1.8rem;
            margin-bottom: 30px;
            font-weight: bold;
            text-align: left;
            padding: 0 10px;
        }

        .quiz-options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .quiz-option {
            background: #333;
            color: #fff;
            border: 2px solid #555;
            padding: 20px;
            font-size: 1.5rem;
            border-radius: 10px;
            cursor: default; /* 参加者が押すわけではないので */
            text-align: left;
            transition: all 0.3s;
            position: relative;
        }

        /* 正解発表時のスタイル */
        .quiz-option.correct-answer {
            background: var(--correct-color);
            border-color: #ff0000;
            color: #fff;
            animation: pulse 1s infinite;
        }
        
        .quiz-option.correct-answer::after {
            content: "正解";
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-family: 'Reggae One', serif;
            font-size: 1.2rem;
            background: #fff;
            color: var(--correct-color);
            padding: 2px 10px;
            border-radius: 5px;
        }

        .quiz-option.fade-out {
            opacity: 0.3;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        .quiz-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .control-btn {
            padding: 15px 40px;
            font-size: 1.5rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Reggae One', serif;
            transition: transform 0.2s;
        }
        
        .btn-prev { background: #555; color: #fff; padding: 15px 20px; font-size: 1.2rem; }
        .btn-show { background: var(--quiz-color); color: #fff; }
        .btn-next { background: var(--accent-color); color: #000; }
        .control-btn:hover { transform: scale(1.05); }

        /* --- 箱の中身スタイル --- */
        .group-box {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #444;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .group-title {
            font-weight: bold;
            color: var(--accent-color);
            display: block;
            margin-bottom: 5px;
            font-size: 1.2rem;
        }
        .group-members {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .point-rule {
            background: #000;
            border: 2px solid var(--accent-color);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            font-family: 'DotGothic16', sans-serif;
        }
        .point-rule span {
            color: var(--accent-color);
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 10px;
        }

        /* 固定スコアボード */
        .scoreboard-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(20, 20, 20, 0.95);
            border-top: 3px solid var(--accent-color);
            padding: 15px 10px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.8);
            z-index: 100;
            height: 320px; /* 固定高さ */
            overflow-y: auto;
        }

        .scoreboard-header {
            text-align: center;
            font-size: 1.2rem;
            color: #888;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1000px;
            margin: 0 auto 10px auto;
        }

        .reset-all-btn {
            background: #c0392b;
            color: #fff;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 10px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .player-card {
            background: #2c3e50;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            border: 1px solid #444;
            transition: transform 0.2s;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .player-card:hover {
            border-color: var(--accent-color);
        }

        .player-name {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .score-display {
            font-size: 2.5rem;
            color: var(--accent-color);
            font-weight: bold;
            margin: 5px 0;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }

        .btn-point {
            border: none;
            border-radius: 4px;
            padding: 8px 0;
            font-weight: bold;
            cursor: pointer;
            color: #fff;
            font-size: 1rem;
            transition: background 0.1s;
        }

        .btn-add-1 { background: var(--quiz-color); }
        .btn-add-3 { background: var(--box-color); }
        .btn-minus { background: #555; grid-column: span 2; font-size: 0.8rem; padding: 4px 0;}

        .btn-point:active { transform: scale(0.95); }

        /* リセット確認モーダル */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.2s ease;
        }
        .modal-content {
            background: var(--card-bg);
            border: 2px solid var(--accent-color);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
        }
        .modal-content p {
            font-size: 1.2rem;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1rem;
        }
        .modal-btn.cancel { background: #555; color: #fff; }
        .modal-btn.confirm { background: #c0392b; color: #fff; }

        /* --- ログイン画面のスタイル --- */
        #login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        .login-box {
            background: #1e1e1e;
            padding: 40px;
            border: 2px solid #d4af37;
            border-radius: 10px;
            text-align: center;
            color: #f0f0f0;
            width: 90%;
            max-width: 400px;
        }
        .login-input {
            display: block;
            margin: 15px auto;
            padding: 12px;
            width: 80%;
            font-size: 1rem;
            border: 1px solid #555;
            background: #333;
            color: #fff;
            border-radius: 5px;
        }
        .login-btn {
            padding: 12px 40px;
            background: #d4af37;
            color: #000;
            border: none;
            font-weight: bold;
            cursor: pointer;
            font-size: 1.2rem;
            margin-top: 20px;
            border-radius: 5px;
            font-family: 'Reggae One', serif;
        }
        .login-btn:hover {
            background: #f1c40f;
        }

        /* レスポンシブ */
        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .tab-btn { font-size: 1rem; padding: 10px 15px; }
            .players-grid { grid-template-columns: repeat(3, 1fr); }
            body { padding-bottom: 400px; }
            .scoreboard-panel { height: 380px; }
            .quiz-options-grid { grid-template-columns: 1fr; }
            .btn-prev { padding: 15px 15px; font-size: 1rem; }
        }
    </style>
</head>
<body>

<!-- 簡易ログインオーバーレイ -->
<div id="login-overlay">
    <div class="login-box">
        <h2 style="font-family: 'Reggae One', serif; color: #d4af37; margin-top:0;">ACCESS RESTRICTED</h2>
        <p>企画チームB 限定コンテンツ<br>IDとパスワードを入力してください</p>
        <input type="text" id="login-id" class="login-input" placeholder="ID" onkeypress="handleLoginKey(event)">
        <input type="password" id="login-pass" class="login-input" placeholder="Password" onkeypress="handleLoginKey(event)">
        <button class="login-btn" onclick="checkLogin()">UNLOCK</button>
        <p id="login-error" style="color: #e74c3c; display: none; margin-top: 15px; font-weight:bold;">IDまたはパスワードが違います</p>
    </div>
</div>

<div class="container">
    <header>
        <h1>企画チームB 出し物</h1>
    </header>

    <!-- タブ切り替えボタン -->
    <div class="tab-container">
        <button class="tab-btn active" onclick="switchTab('quiz')">Q. クイズ大会</button>
        <button class="tab-btn" onclick="switchTab('box')">? 箱の中身</button>
    </div>

    <!-- クイズ大会セクション -->
    <div id="quiz" class="content-section active">
        <h2 class="quiz-title">ぼくたちの今年 - QUIZ 2025</h2>
        <p style="text-align:center; margin-bottom:20px;">企画チームBメンバーの「個人的な近況」を知ってもらうクイズです！</p>
        
        <!-- クイズ表示エリア -->
        <div id="quiz-display" class="quiz-container">
            <div class="quiz-meta">
                <span id="quiz-presenter" class="quiz-presenter">担当者名</span>
                <span id="quiz-count" class="quiz-number">Q.1</span>
            </div>

            <!-- 画像・動画エリア -->
            <div class="quiz-media-box">
                <img id="quiz-image" src="" alt="問題画像" style="display:none;">
                <video id="quiz-video" src="" controls style="display:none;"></video>
                <div id="quiz-media-placeholder" style="color:#666;">（画像/動画エリア）</div>
            </div>

            <div id="quiz-text" class="quiz-question-text">
                ここに問題文が表示されます。
            </div>

            <div id="quiz-options" class="quiz-options-grid">
                <div class="quiz-option" id="opt-0">A. 選択肢1</div>
                <div class="quiz-option" id="opt-1">B. 選択肢2</div>
                <div class="quiz-option" id="opt-2">C. 選択肢3</div>
                <div class="quiz-option" id="opt-3">D. 選択肢4</div>
            </div>

            <div class="quiz-controls">
                <button id="btn-prev" class="control-btn btn-prev" onclick="prevQuestion()" style="display:none;">前へ</button>
                <button id="btn-answer" class="control-btn btn-show" onclick="showAnswer()">正解を表示</button>
                <button id="btn-next" class="control-btn btn-next" onclick="nextQuestion()" style="display:none;">次の問題へ</button>
            </div>
        </div>

        <!-- 終了メッセージ -->
        <div id="quiz-end" style="display:none; text-align:center; padding:50px;">
            <h3 style="font-size:2rem; color:var(--accent-color);">クイズ終了！</h3>
            <p>お疲れ様でした！</p>
        </div>

    </div>

    <!-- 箱の中身セクション -->
    <div id="box" class="content-section">
        <h2 class="box-title">箱の中身はなんだろな？ - 恐怖のブラックボックス</h2>
        <ul>
            <li>問題が2問あり、二手に分かれて参加してもらいます。</li>
        </ul>

        <div class="group-box">
            <span class="group-title">▼ 1問目</span>
            <div class="group-members">RENちゃん、安達さん、さとし</div>
        </div>

        <div class="group-box">
            <span class="group-title">▼ 2問目</span>
            <div class="group-members">おったん、小田ちゃん、としくん、ようちゃん</div>
        </div>

        <ul>
            <li>ヤジ大歓迎ですが、見てる方は正解を言わないようにｗ</li>
            <li>一人ずつ箱に手を入れて確認します：<strong style="color:var(--box-color);">制限時間10秒</strong></li>
            <li>グループ全員が確認したら画用紙にペンで回答を書きます</li>
            <li><span style="color:#e74c3c; font-weight:bold;">注意：個人戦なので回答時に相談しないようにしてください</span></li>
            <li>一斉に回答オープン！</li>
        </ul>

        <div class="point-rule" style="text-align: left; display: inline-block; width: 100%; box-sizing: border-box;">
            <div style="display:flex; justify-content: space-around;">
                <div style="text-align:center;">ドンピシャ<br><span>3点獲得</span></div>
                <div style="text-align:center;">おしい！<br><span>1点獲得</span></div>
                <div style="text-align:center;">不正解<br><span style="color:#888;">0点</span></div>
            </div>
        </div>
    </div>
</div>

<!-- リアルタイム集計パネル -->
<div class="scoreboard-panel">
    <div class="scoreboard-header">
        <span class="dot-font">REALTIME SCOREBOARD</span>
        <button class="reset-all-btn" onclick="resetAllScores()">Reset All</button>
    </div>
    
    <div class="players-grid" id="playersGrid">
        <!-- JSでプレイヤーカードを生成 -->
    </div>
</div>

<!-- リセット確認モーダル -->
<div id="resetModal" class="modal-overlay">
    <div class="modal-content">
        <p>【確認】<br>本当に全員のスコアを<br>0にリセットしますか？</p>
        <div class="modal-buttons">
            <button class="modal-btn cancel" onclick="closeResetModal()">キャンセル</button>
            <button class="modal-btn confirm" onclick="executeReset()">リセットする</button>
        </div>
    </div>
</div>

<script>
    /* =========================================
       簡易ログイン機能
       ========================================= */
    function checkLogin() {
        const id = document.getElementById('login-id').value;
        const pass = document.getElementById('login-pass').value;
        const errorMsg = document.getElementById('login-error');
        
        // パスワード判定 (teamb / 1qAZXSw2)
        if (id === 'teamb' && pass === '1qAZXSw2') {
            document.getElementById('login-overlay').style.display = 'none';
        } else {
            errorMsg.style.display = 'block';
            // 揺れるアニメーション
            const box = document.querySelector('.login-box');
            box.style.transform = 'translateX(10px)';
            setTimeout(() => box.style.transform = 'translateX(-10px)', 50);
            setTimeout(() => box.style.transform = 'translateX(10px)', 100);
            setTimeout(() => box.style.transform = 'translateX(0)', 150);
        }
    }

    // Enterキーでもログイン可能にする
    function handleLoginKey(e) {
        if (e.key === 'Enter') checkLogin();
    }

    /* =========================================
       クイズデータ（ここを編集して問題を作成）
       ========================================= */
    // 画像は https://placehold.co/600x400/000000/FFF?text=Question+Image のようなダミーを入れています
    const quizData = [
        // 赤岡先生 (Q1, Q2)
        {
            presenter: "赤岡先生からの出題",
            question: "第1問：今年、赤岡先生がこっそり始めた趣味はどれでしょう？",
            options: ["A. ソロキャンプ", "B. バイオリン", "C. ポケモンカード", "D. 筋トレ"],
            answerIndex: 0, // A=0, B=1, C=2, D=3
            mediaType: "image", // image or video or none
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q1+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q1+Answer" // 正解時の画像
        },
        {
            presenter: "赤岡先生からの出題",
            question: "第2問：赤岡先生が今年一番高かった買い物は？",
            options: ["A. ドラム式洗濯機", "B. 高級腕時計", "C. 車の修理代", "D. 仮想通貨"],
            answerIndex: 2,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q2+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q2+Answer"
        },
        // もっつ (Q3, Q4)
        {
            presenter: "もっつからの出題",
            question: "第3問：もっつが最近ハマっているコンビニスイーツは？",
            options: ["A. ファミマのフラッペ", "B. ローソンのバスチー", "C. セブンのカヌレ", "D. ミニストップのソフト"],
            answerIndex: 1,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q3+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q3+Answer"
        },
        {
            presenter: "もっつからの出題",
            question: "第4問：もっつが今年行った旅行先で一番良かった場所は？",
            options: ["A. 北海道", "B. 沖縄", "C. 台湾", "D. 近所のスーパー銭湯"],
            answerIndex: 0,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q4+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q4+Answer"
        },
        // 西川 (Q5, Q6)
        {
            presenter: "西川からの出題",
            question: "第5問：西川が最近やらかした最大の失敗は？",
            options: ["A. 財布を落とした", "B. 会議で寝た", "C. 終電を逃して歩いて帰宅", "D. 料理でボヤ騒ぎ"],
            answerIndex: 2,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q5+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q5+Answer"
        },
        {
            presenter: "西川からの出題",
            question: "第6問：西川が来年挑戦したいことは？",
            options: ["A. フルマラソン", "B. 英語学習", "C. 婚活", "D. YouTuberデビュー"],
            answerIndex: 0,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q6+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q6+Answer"
        },
        // 祐三さん (Q7, Q8)
        {
            presenter: "祐三さんからの出題",
            question: "第7問：祐三さんが今年一番食べたラーメンの回数は？",
            options: ["A. 50回", "B. 100回", "C. 150回", "D. 365回"],
            answerIndex: 1,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q7+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q7+Answer"
        },
        {
            presenter: "祐三さんからの出題",
            question: "第8問：祐三さんの今のスマホの待ち受け画面は？",
            options: ["A. 飼い猫", "B. 愛車", "C. 初期設定のまま", "D. 好きなアイドル"],
            answerIndex: 3,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q8+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q8+Answer"
        },
        // あべちゃん (Q9, Q10)
        {
            presenter: "あべちゃんからの出題",
            question: "第9問：あべちゃんが今年一番感動した映画は？",
            options: ["A. ゴジラ-1.0", "B. 君たちはどう生きるか", "C. トップガン(家で見た)", "D. アンパンマン"],
            answerIndex: 0,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q9+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q9+Answer"
        },
        {
            presenter: "あべちゃんからの出題",
            question: "第10問：あべちゃんからのメッセージ。「みんなに一言！」",
            options: ["A. お金貸して", "B. 愛してるぜ", "C. 健康第一", "D. 飲みに行こう"],
            answerIndex: 2,
            mediaType: "image",
            mediaSrc: "https://placehold.co/600x400/1e1e1e/d4af37?text=Q10+Image",
            answerMediaSrc: "https://placehold.co/600x400/1e1e1e/e74c3c?text=Q10+Answer"
        }
    ];

    /* =========================================
       クイズ進行ロジック
       ========================================= */
    let currentQuizIndex = 0;

    function renderQuiz() {
        if (currentQuizIndex >= quizData.length) {
            document.getElementById('quiz-display').style.display = 'none';
            document.getElementById('quiz-end').style.display = 'block';
            return;
        }

        const data = quizData[currentQuizIndex];
        
        // テキスト更新
        document.getElementById('quiz-presenter').textContent = data.presenter;
        document.getElementById('quiz-count').textContent = `Q.${currentQuizIndex + 1}`;
        document.getElementById('quiz-text').textContent = data.question;

        // メディア更新
        const imgEl = document.getElementById('quiz-image');
        const vidEl = document.getElementById('quiz-video');
        const phEl = document.getElementById('quiz-media-placeholder');

        imgEl.style.display = 'none';
        vidEl.style.display = 'none';
        phEl.style.display = 'none';

        if (data.mediaType === 'image' && data.mediaSrc) {
            imgEl.src = data.mediaSrc;
            imgEl.style.display = 'block';
        } else if (data.mediaType === 'video' && data.mediaSrc) {
            vidEl.src = data.mediaSrc;
            vidEl.style.display = 'block';
        } else {
            phEl.style.display = 'block';
        }

        // 選択肢更新
        for(let i=0; i<4; i++) {
            const optEl = document.getElementById(`opt-${i}`);
            optEl.textContent = data.options[i];
            optEl.className = 'quiz-option'; // クラスリセット
        }

        // ボタンリセット
        document.getElementById('btn-answer').style.display = 'inline-block';
        document.getElementById('btn-next').style.display = 'none';

        // 戻るボタンの制御（1問目は非表示）
        document.getElementById('btn-prev').style.display = currentQuizIndex > 0 ? 'inline-block' : 'none';
    }

    function showAnswer() {
        const data = quizData[currentQuizIndex];
        
        // 正解の強調
        for(let i=0; i<4; i++) {
            const optEl = document.getElementById(`opt-${i}`);
            if (i === data.answerIndex) {
                optEl.classList.add('correct-answer');
            } else {
                optEl.classList.add('fade-out');
            }
        }

        // 正解時の画像切り替え（あれば）
        if (data.answerMediaSrc) {
             const imgEl = document.getElementById('quiz-image');
             const vidEl = document.getElementById('quiz-video');
             // 動画の場合は切り替えない等の制御も可能だが、ここでは画像があれば画像に切り替え
             if(data.mediaType === 'image') {
                 imgEl.src = data.answerMediaSrc;
             }
        }

        // ボタン切り替え
        document.getElementById('btn-answer').style.display = 'none';
        document.getElementById('btn-next').style.display = 'inline-block';
    }

    function nextQuestion() {
        currentQuizIndex++;
        renderQuiz();
    }

    // 前の問題へ戻る
    function prevQuestion() {
        if (currentQuizIndex > 0) {
            currentQuizIndex--;
            renderQuiz();
        }
    }


    /* =========================================
       得点管理・タブ切り替えロジック
       ========================================= */
    // 参加者リスト
    const players = [
        "小田ちゃん", 
        "RENちゃん", 
        "安達さん", 
        "さとし", 
        "おったん", 
        "としくん", 
        "ようちゃん"
    ];

    // 初期スコア（ローカルストレージから読み込むか、0で初期化）
    let scores = {};

    // 初期化処理
    function init() {
        const savedScores = localStorage.getItem('bonenkai_teamB_scores');
        if (savedScores) {
            scores = JSON.parse(savedScores);
        } else {
            players.forEach(p => scores[p] = 0);
        }
        renderScoreboard();
        
        // クイズ初期表示
        renderQuiz();
    }

    // スコアボード描画
    function renderScoreboard() {
        const grid = document.getElementById('playersGrid');
        grid.innerHTML = '';

        players.forEach(player => {
            const currentScore = scores[player] || 0;
            
            const card = document.createElement('div');
            card.className = 'player-card';
            card.innerHTML = `
                <div class="player-name">${player}</div>
                <div class="score-display score-num" id="score-${player}">${currentScore}</div>
                <div class="btn-group">
                    <button class="btn-point btn-add-1" onclick="updateScore('${player}', 1)">+1</button>
                    <button class="btn-point btn-add-3" onclick="updateScore('${player}', 3)">+3</button>
                    <button class="btn-point btn-minus" onclick="updateScore('${player}', -1)">-1</button>
                </div>
            `;
            grid.appendChild(card);
        });
    }

    // スコア更新処理
    function updateScore(player, delta) {
        if (scores[player] === undefined) scores[player] = 0;
        scores[player] += delta;
        if (scores[player] < 0) scores[player] = 0; // マイナスにはしない

        const scoreEl = document.getElementById(`score-${player}`);
        scoreEl.innerText = scores[player];
        
        scoreEl.style.color = '#fff';
        scoreEl.style.transform = 'scale(1.2)';
        setTimeout(() => {
            scoreEl.style.color = 'var(--accent-color)';
            scoreEl.style.transform = 'scale(1)';
        }, 200);

        saveScores();
    }

    // 全リセット（モーダル表示）
    function resetAllScores() {
        document.getElementById('resetModal').classList.add('active');
    }

    // モーダルを閉じる
    function closeResetModal() {
        document.getElementById('resetModal').classList.remove('active');
    }

    // リセット実行
    function executeReset() {
        players.forEach(p => scores[p] = 0);
        renderScoreboard();
        saveScores();
        closeResetModal();
    }

    // ローカルストレージ保存
    function saveScores() {
        localStorage.setItem('bonenkai_teamB_scores', JSON.stringify(scores));
    }

    // タブ切り替え
    function switchTab(tabId) {
        const quizTabBtn = document.querySelector('button[onclick="switchTab(\'quiz\')"]');
        const isQuizActive = quizTabBtn.classList.contains('active');

        // ★追加機能：クイズタブが既にアクティブな状態で、再度クイズタブを押した場合 -> 最初に戻る（リセット）
        if (tabId === 'quiz' && isQuizActive) {
            currentQuizIndex = 0;
            document.getElementById('quiz-end').style.display = 'none';
            document.getElementById('quiz-display').style.display = 'block';
            renderQuiz();
            return;
        }

        document.querySelectorAll('.content-section').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');

        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        if (tabId === 'quiz') {
            quizTabBtn.classList.add('active');
        } else {
            document.querySelector('button[onclick="switchTab(\'box\')"]').classList.add('active');
        }
    }

    // 実行
    init();

</script>

</body>
</html>
